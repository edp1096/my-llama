<html>

<head>
    <meta charset="utf-8">
    <title>My-LLAMA</title>
</head>

<body>
    <div>
        <textarea id="inputs">Do you know kimchi?</textarea>
    </div>

    <button id="send" onclick="send()">Send</button>
    <button id="send" onclick="stopResponse()">Stop</button>

    <div id="outputs"></div>
</body>

<script>
    const loc = window.location
    let uri = 'ws:'

    if (loc.protocol === 'https:') uri = 'wss:'

    uri += '//' + "localhost" + ":1323"
    uri += "/" + 'ws'

    ws = new WebSocket(uri)

    ws.onopen = function () {
        console.log('Connected')
    }

    ws.onmessage = function (evt) {
        var out = document.getElementById('outputs')
        out.innerHTML = evt.data.replace(/\n/g, "<br />")
        // ws.close()
    }

    function send() {
        const input = document.querySelector("#inputs")
        if (input.value === '') {
            return
        }

        ws.send(input.value)

        input.value = ''
        input.focus()
    }

    function stopResponse() {
        const input = document.querySelector("#inputs")
        const stopmsg = "$$__STOP__$$"

        ws.send(stopmsg)

        input.value = ''
        input.focus()
    }
</script>

</html>